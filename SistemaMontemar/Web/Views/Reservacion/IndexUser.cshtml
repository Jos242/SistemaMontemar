@model IEnumerable<Infrastructure.Models.Reservacion>

@{
    ViewBag.Title = "Index";
}

<h2>Reservations</h2>

<p>
    <a href="@Url.Action("Create", "Reservacion", null)" class="btn btn-primary">Make New Reservation</a>
</p>
<div id="resultado">
    <table class="table">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Area)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FechaInicio)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FechaFinal)
            </th>
            @{
                int status = ViewBag.status;
            }
            <th>
                <button class="btn btn-outline-primary" onclick="change(@status, 0)">@Html.DisplayNameFor(model => model.Estado)  <i class="@(status==0?"fa-solid fa-ban":status==-1?"fa-solid fa-check":status==-2?"fa-solid fa-hourglass-start":"")"></i></button>
            </th>
            <th></th>
        </tr>



        @foreach (var item in Model)
        {

            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Area.Descripcion)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.FechaInicio)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.FechaFinal)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Estados[item.Estado])
                </td>
            </tr>
        }

    </table>
</div>

@section Scripts{
    <script type="text/javascript">
function change(idReservacion, AccORjc) {
            $.ajax({
                method: 'POST',
                url: '/Reservacion/AjaxCambiar',
                data: { 'idReservacion': idReservacion, 'AccORjc': AccORjc },
                success: function (response) {
                    $('#resultado').html('');
                    $('#resultado').html(response);
                }, error: function (xhr, status, error) {
                    console.log('Error' + error + ',No Error' + xhr.status);
                }
            })
}
    </script>
}